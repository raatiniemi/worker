#!/bin/bash
GCLOUD=$(which gcloud);
if [ -z "${GCLOUD}" ]; then
  echo "Unable to find gcloud binary";
  exit 1;
fi;

if [ -z "${GCLOUD_PROJECT_ID}" ]; then
  echo "No project id is available for gcloud configuration";
  exit 1;
fi;

if [ -z "${GCLOUD_SERVICE_ACCOUNT}" ]; then
  echo "No service account configuration is available for gcloud";
  exit 1;
fi;

$GCLOUD config set project $GCLOUD_PROJECT_ID;

echo $GCLOUD_SERVICE_ACCOUNT > service-account.json;
$GCLOUD auth activate-service-account --key-file service-account.json;
